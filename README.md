# Что это
Небольшое Python приложение, которое слушает аудиопоток домофона Fnet/Ufanet и услышав серию нажатий любых кнопок домофона отправляет веб-хук.

Я отправляю хук в hass, дверь открывает интеграция: https://github.com/Muxee4ka/ucams_home_assistant/

# Как использовать

Для домофонов Fnet может работать as is:
1. Создай `.env` файл с кредами от приложения Fnet
   ```
   UFA_USER=""
   UFA_PASS=""
   ```
2. Установи зависимости `pip install -r requirements.txt`
3. Поменяй настройки в `main.py` (адрес хука, длина серии)
4. Запусти скрипт `python main.py`

Если нажатия не определяются, можно заменить частоты на нужные
1. Запиши звуки нажатия кнопок `python recorder.py`
2. Вырежи небольшой (0.02 - 0.03 секунды) образец чистого звука `ffmpeg -i input.mp4  -ss 3.00 -t 0.03 -vn beep.wav` (ss — время старта, t — длительность)
3. Посмотри на каких частотах 800+ Гц есть пики `python analyze_beep.py beep.wav`
4. Укажи эти частоты в `TARGET_FREQUENCIES` `main.py`
5. Ещё можно поиграться с `ENERGY_THRESHOLD_MULTIPLIER`. Меньше значение — больше чувствительность

Чтобы развернуть в контейнере:
1. Создай `.env` файл с кредами от приложения Fnet
   ```
   UFA_USER=""
   UFA_PASS=""
   ```
2. Поменяй настройки в `main.py` (адрес хука, длина серии)
3. Вызови `docker compose up -d`
